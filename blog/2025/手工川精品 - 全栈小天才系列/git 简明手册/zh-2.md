# Git 速查表

![cover-7.jpg](file0.jpg)

# 前言

本书旨在作为Git命令的快速参考。

关于Git（最流行的版本控制软件）的介绍，请参考我的[Git手册](https://flaviocopes.com/books)。

本书发布于2024年底。

# 法律声明

Flavio Copes，2024年。保留所有权利。

从[flaviocopes.com](https://flaviocopes.com)下载。

未经出版商事先书面许可，不得以任何形式或通过任何方式复制、分发或传播本书的任何部分，包括影印、录制或其他电子或机械方法。

本书中的信息仅供教育和参考之用，不应被视为法律、财务或其他专业建议。作者和出版商对本书中任何信息的准确性、完整性、适用性或有效性不作任何陈述，对使用这些信息可能导致的任何错误、遗漏、延迟或由此产生的损失、伤害或损害不承担责任。

本书免费提供给Flavio Copes的通讯订阅者。它仅供个人使用。未经作者事先书面许可，严禁重新分发、转售或将本书或其任何部分用于商业用途。

如果您希望分享本书的一部分，请适当注明出处，标明Flavio Copes并包含[flaviocopes.com](http://flaviocopes.com)的链接。

# 前言

欢迎阅读Git速查表，这是一份全面的指南，旨在帮助初学者和经验丰富的开发人员掌握有效使用Git（软件行业最流行的版本控制系统）所需的知识。这份速查表设计为您的首选资源，无论您是管理个人项目还是在大型团队中协作。通过提供清晰的解释和实用的示例，它旨在揭开Git的复杂性，将其转化为直观、可操作的见解。

在本指南中，您将探索各种Git命令和概念，这些是软件版本控制的基础。从初始化存储库和提交更改等基本操作，到分支、合并和变基等更高级的技术，本速查表涵盖了所有内容。您还将深入研究特殊主题，如压缩提交、二分查找调试、处理子模块和实现子树，确保您能够应对开发过程中出现的任何挑战。

随着学习的深入，您将学习如何维护数据完整性、管理多个工作树以及高效解决合并冲突。每个部分都结构清晰，提供逐步指导，使您能够立即在项目中应用所学知识。到本旅程结束时，您不仅会对Git有更深入的理解，还会有信心使用它来简化工作流程并增强与同事的协作。

为了充分受益于本速查表，建议读者具备命令行操作和一般编程原则的基础知识。熟悉使用终端或命令提示符将显著帮助理解和应用所提供的示例。此外，对版本控制概念有基本了解将增强您有效浏览本指南的能力。

# **基本Git命令**

在本节中，我们深入探讨了作为高效管理和导航Git存储库的基础的基本Git命令。Git是一个分布式版本控制系统，对于跟踪代码库中的更改、与其他开发人员协作以及维护项目历史的完整性至关重要。理解这些基本命令对于任何希望在开发工作流程中充分利用Git功能的人来说都是至关重要的。

我们将探索各种命令，涵盖Git使用的关键方面，如初始化新存储库、提交更改、分支和合并。每个命令都有一个简短的句子描述其用途，并附有实际示例，说明如何在实际场景中有效使用它。无论您是设置新项目还是处理现有代码库，这些命令都将帮助您保持工作有序并维持无缝的工作流程。

### `git help`

`git help`命令打印Git帮助信息。它提供了Git基本用法和最常用Git命令的快速参考。当您需要快速回顾Git的功能或想要探索可用命令时，此命令非常有用。

您还可以使用`git help <command>`显示任何特定Git命令的帮助信息。例如，`git help git`专门打印Git命令本身的Git帮助。

这些帮助命令对于初学者和有经验的用户来说都是宝贵的资源，可以快速获取有关Git功能和用法的信息。

### `git version`

`git version`命令显示系统上安装的Git版本。此命令用于验证您当前使用的Git版本，这对于与某些功能的兼容性或在排除问题时可能很重要。

### `git init`

`git init`命令用于在当前目录中初始化一个新的Git存储库。此命令创建一个名为`.git`的新子目录，其中包含新存储库所需的所有元数据。这通常是您在开始想要用Git管理的新项目时运行的第一个命令。运行此命令后，您可以开始在新的Git存储库中跟踪文件并进行提交。

### `git clone <repository_url>`

`git clone <repository_url>`命令在本地机器上创建远程Git存储库的副本。它下载所有文件、分支和提交历史，使您可以立即开始处理项目。

### `git status`

`git status`命令显示Git存储库工作目录和暂存区的当前状态。它显示有关哪些文件已被修改、添加或删除的信息，以及这些更改是否已暂存以供下一次提交。

# **工作目录和暂存区**

工作目录和暂存区是Git中的基本概念，在版本控制过程中发挥着关键作用。工作目录是您积极对文件进行更改的环境，代表项目的当前状态。它本质上是一个沙盒，您可以在开发项目时自由编辑、删除和创建文件。但是，这些更改仅限于您的机器，尚未成为版本历史的一部分。

另一方面，暂存区（也称为索引）作为工作目录和存储库之间的中间空间。它充当一个检查点，您可以在将更改提交到存储库历史之前有选择地组织更改。这使您可以准备一组逻辑相关的更改，确保每次提交都有意义且连贯。

以下命令将帮助管理工作目录和暂存区之间的更改。它们使您能够将文件添加到暂存区、删除它们或修改现有文件，让您控制下一次提交中将包含的内容。通过使用这些命令，您可以确保只有预期的更新被提交，使项目历史清晰有序。这个过程对于维护干净且可理解的历史至关重要，因为它允许您精确清晰地跟踪项目的演变。

### `git checkout .`

`git checkout .`命令丢弃工作目录中的所有更改，将文件恢复到最后提交的状态。此命令对于快速撤销本地修改并将工作目录恢复到干净状态非常有用。

### `git reset -p`

`git reset -p`命令允许您交互式地重置工作目录中的更改。它提供了一种选择性撤销修改的方法，让您对保留或丢弃哪些更改有精细控制。

### `git add <file>`

`git add <file>`命令将特定文件添加到Git中的暂存区。这为下一次提交准备文件，允许您选择性地选择要包含在版本历史中的更改。

### `git add -p`

允许您通过将更改分解为块（hunks）来交互式地暂存工作目录中的更改，使您能够在提交前查看并选择性地将部分更改添加到索引中。

### `git add -i`

进入添加文件的交互模式。提供基于文本的交互式菜单，您可以在其中选择要执行的各种操作，如暂存单个更改、更新文件或查看状态。

### `git rm <file>`

从工作目录中删除文件并暂存删除操作

### `git rm --cached <file>`

从暂存区（索引）中删除指定文件，但在工作目录中保持完整，有效地从版本控制中取消跟踪该文件。

### `git mv <old_path> <new_path>`

`git mv <old_path> <new_path>`命令用于在Git存储库中移动或重命名文件或目录。它自动暂存更改，使其准备好进行下一次提交。

### `git commit -m "message"`

`git commit -m "message"`命令用于在Git存储库中创建新的提交。它保存已暂存（添加到索引）的更改，并附带描述性消息。此消息应简要说明在此提交中进行了哪些更改。

# **使用分支**

Git分支是Git存储库内的并行开发线，允许您独立于主代码库处理不同的功能、错误修复或实验。每个分支可以有自己的提交历史，一个分支中的更改在合并之前不会影响其他分支。这有助于组织工作，并通过使多个开发人员能够同时处理项目的不同方面而不干扰彼此的进展，从而促进协作。

在本节中，我们将介绍允许您在Git存储库中创建、切换、列出、重命名和删除分支的命令。这些命令帮助管理并行开发线，使您能够独立处理不同的功能或错误修复。您还将学习如何显示提交历史和分支关系，以及管理远程分支。

### `git branch <branch_name>`

创建一个新分支

### `git checkout <branch_name>`

切换到指定分支并更新工作目录

### `git branch`

列出所有分支

### `git branch -d <branch_name>`

删除一个分支

### `git push --delete <remote> <branch>`

删除远程分支

### `git branch -m <old_name> <new_name>`

重命名分支

### `git checkout -b <new_branch>`

创建并切换到基于当前分支的新分支`<new_branch>`。

### `git switch <branch>`

将工作目录切换到指定分支

### `git show-branch <branch>`

显示所有或选定分支的提交历史和分支关系摘要，显示每个分支的分叉点

### `git show-branch --all`

与上面相同，但适用于所有分支及其提交。

### `git branch -r`

列出本地存储库知道的所有远程分支

### `git branch -a`

列出存储库中的所有分支，包括本地和远程分支（本地存储库知道的分支）

### `git branch --merged`

列出已完全合并到当前分支的所有分支，如果不再需要，可以安全删除

### `git branch --no-merged`

列出尚未完全合并到当前分支的所有分支，显示尚未整合的更改分支

# **合并**

git merge命令用于将一个分支的更改合并到另一个分支。它整合了两个分支的历史，创建一个包含两个来源更改的新提交。这个过程允许多条开发线被整合在一起，促进协作并确保所有更新都被纳入主项目。在合并过程中，如果更改重叠，可能会出现冲突，需要手动解决以确保最终结果的连贯性。

### `git merge <branch>`

将指定分支的更改整合到当前分支，合并它们的历史

### `git merge --no-ff <branch>`

将指定分支合并到当前分支，即使可以进行快进合并，也始终创建新的合并提交

### `git merge --squash <branch>`

将指定分支的所有更改合并为单个提交，准备在当前分支中提交更改，但不合并分支的历史，允许您手动编辑提交消息。

### `git merge --abort`

取消正在进行的合并过程，并将工作目录和索引的状态恢复到合并开始前的状态。

### `git merge -s ours <branch>`

### `git merge —-strategy=ours <branch>`

使用"ours"策略执行合并，保留当前分支的更改并丢弃指定分支的更改，有效地合并历史而不整合来自其他分支的更改。

### `git merge --strategy=theirs <branch>`

使用"theirs"策略将指定分支合并到当前分支，通过偏向被合并分支的更改来解决所有冲突（注意："theirs"策略不是内置策略，通常需要自定义脚本或与工具一起使用来处理冲突解决）。

# **远程仓库**

Git远程仓库是对远程存储库的引用，这些存储库是托管在互联网或其他网络上的项目版本。它们通过允许多个用户与中央存储库共享和同步更改来实现协作。远程仓库的常见操作包括git fetch获取更新，git pull获取并合并更改，以及git push将本地提交上传到远程存储库。管理远程仓库涉及添加、删除和重命名远程连接，以及配置URL以实现无缝协作。

### `git fetch`

从远程存储库获取更改，但不将它们合并到当前分支

### `git pull`

从远程存储库获取更改并立即将它们合并到当前分支

### `git push`

将本地分支的更改上传到远程存储库

### `git remote`

列出为本地存储库配置的远程存储库名称

### `git remote -v`

显示与本地存储库关联的远程存储库的URL，显示获取和推送URL

### `git remote add <name> <url>`

将指定名称和URL的新远程存储库添加到本地存储库配置中。

### `git remote remove <name>`

### `git remote rm <name>`

从本地git配置中删除指定的远程存储库连接

### `git remote rename <old_name> <new_name>`

在本地git配置中更改现有远程存储库连接的名称

### `git remote set-url <name> <newurl>`

在本地git配置中更改现有远程存储库连接的URL

### `git fetch <remote>`

从指定的远程存储库检索最新更改，更新远程分支的本地副本，但不将它们合并到本地分支中。

### `git pull <remote>`

从指定的远程存储库获取更改并将它们合并到当前分支

### `git remote update`

获取存储库跟踪的所有远程仓库的更新。

### `git push <remote> <branch>`

将本地存储库中的指定分支上传到给定的远程存储库

### `git push <remote> --delete <branch>`

从远程存储库中删除指定分支

### `git remote show <remote>`

显示有关指定远程存储库的详细信息，包括其URL、获取和推送配置以及它跟踪的分支

### `git ls-remote <repository>`

列出指定远程存储库中的引用（如分支和标签）及其提交ID。此命令允许您查看远程存储库中可用的分支和标签，而无需克隆它。

### `git push origin <branch> --set-upstream`

将本地分支`<branch>`推送到远程存储库origin，并设置本地分支跟踪远程分支，以便将来的git push和git pull命令将默认为此远程分支。

### `git remote add upstream <repository>`

将一个名为upstream的新远程仓库添加到本地存储库，指向指定的`<repository>`。这通常用于跟踪您从中分叉的原始存储库，而origin通常指的是您自己的分叉。

### `git fetch upstream`

从upstream远程存储库检索更新，更新对该远程分支和标签的本地引用，而不修改工作目录或合并更改。

### `git pull upstream <branch>`

从upstream远程存储库的`<branch>`获取更新，并将这些更改合并到当前分支。这通常用于将原始存储库的更改整合到您自己的本地分支中。

### `git push origin <branch>`

将本地分支`<branch>`上传到origin远程存储库，使您的分支及其提交在远程可用。

# **修改提交**

修改Git提交允许您修改最近的提交，通常是为了纠正或更新其内容或消息。这可以使用git commit --amend命令完成，该命令在默认文本编辑器中打开提交以进行更改。修改对于修复小错误或添加忘记的更改而不创建新提交特别有用，从而产生更干净、更准确的提交历史。

### `git commit --amend`

修改最近的提交，合并暂存的更改。

### `git commit --amend -m "new message"`

修改最近提交的提交消息。

### `git commit --fixup=HEAD`

创建一个带有`--fixup`选项的新提交，旨在纠正或修改最近的提交（HEAD）。新提交在提交消息中标有fixup!前缀，并将在交互式变基期间用于自动修复或修改指定的提交。

# **暂存**

Git暂存是一种功能，允许您临时保存工作目录中尚未准备好提交的更改。通过使用git stash命令，您可以将这些更改搁置一旁，并将工作目录恢复到干净状态，使您能够切换分支或执行其他任务而不会丢失进度。稍后，您可以使用git stash apply或git stash pop重新应用暂存的更改，允许您继续之前的工作。当您需要处理紧急问题或尝试不同的代码路径时，这个功能特别有用。

### `git stash`

### `git stash save`

临时保存未提交的更改，允许您切换分支或执行其他操作，而无需提交不完整的工作。

### `git stash -m "message"`

### `git stash save "message"`

与上面相同，但使用消息存储更改

### `git stash show`

显示最近暂存条目中更改的摘要，显示哪些文件被修改

### `git stash list`

显示存储库中所有暂存的更改，以编号列表显示

### `git stash pop`

应用最近的暂存并立即从暂存列表中删除它

### `git stash drop`

从暂存列表中删除最近的暂存条目，而不将其应用到工作目录

### `git stash apply`

重新应用最近暂存的更改到工作目录，但不从暂存列表中删除它们

### `git stash clear`

清除所有暂存条目，永久删除暂存列表中所有保存的更改

### `git stash branch <branch>`

从暂存更改之前所在的提交创建一个名为`<branch>`的新分支，然后将暂存的更改应用到该新分支。此命令有效地允许您在单独的分支中继续处理暂存的更改，保留原始上下文和更改。

# **标签**

Git标签是一种功能，允许您用有意义的名称标记存储库历史中的特定点，通常用于发布或重要里程碑。与分支不同，标签通常是不可变的，不会改变，作为对特定提交的永久引用。Git中有两种类型的标签：轻量级标签，它们是指向提交的简单指针，以及附注标签，它们存储额外的元数据，如标签者的姓名、电子邮件、日期和消息。标签可以轻松创建、列出、推送到远程存储库和删除，提供了一种方便的方式来管理和引用项目开发时间线中的关键点。

### `git tag <tag_name>`

创建一个指向当前提交的新标签（通常用于标记提交历史中的特定点，如发布）

### `git tag -a <tag_name> -m "message"`

创建一个带有指定名称和消息的附注标签，其中包括标签者的姓名、电子邮件和日期等额外元数据，并指向当前提交。

### `git tag -d <tag_name>`

从本地存储库中删除指定标签

### `git tag -f <tag> <commit>`

强制标签指向不同的提交。

### `git show <tag_name>`

显示有关指定标签的详细信息，包括它指向的提交以及任何相关的标签消息或注释

### `git push origin <tag_name>`

将指定标签上传到远程存储库，使其对他人可用

### `git push origin --tags`

将所有本地标签推送到远程存储库，确保所有标签与远程同步

### `git push --follow-tags`

推送提交和标签。

### `git fetch --tags`

从默认远程存储库检索所有标签并用它们更新本地存储库，而不影响当前分支。

# **撤销更改**

在Git中撤销更改涉及撤销对存储库历史所做的修改。这可以通过几个命令完成，例如git revert，它创建一个新的提交，否定指定先前提交的更改，有效地逆转其效果，同时保留提交历史。另一种方法是使用git reset，它将当前HEAD更改为指定的提交，并可以根据所选选项（--soft、--mixed或--hard）更新暂存区和工作目录。此外，git checkout可用于丢弃工作目录中的更改，将文件恢复到最后提交的状态。这些工具在管理和纠正更改方面提供了灵活性，确保存储库保持准确和干净。

### `git checkout -- <file>`

丢弃工作目录中指定文件的更改，将其恢复到最后提交的状态，有效地撤销尚未暂存的任何修改。

### `git revert <commit>`

创建一个新的提交，撤销指定提交中的更改，有效地逆转其效果，同时保留历史。

### `git revert -n <commit>`

撤销提交但不提交结果。

### `git reset`

将当前HEAD重置为指定状态，并可选择更新暂存区和工作目录，取决于使用的选项（--soft、--mixed或--hard）。

### `git reset --soft <commit>`

将HEAD移动到指定的提交，同时保持索引（暂存区）和工作目录不变，因此指定提交之后的所有更改仍然暂存以待提交。当您想撤销提交但保留更改以便再次提交时，这很有用。

### `git reset --mixed <commit>`

将HEAD移动到指定的提交并更新索引（暂存区）以匹配该提交，但保持工作目录不变，因此指定提交之后的更改被保留但未跟踪。

### `git reset --hard <commit>`

将HEAD移动到指定的提交并更新索引（暂存区）和工作目录以匹配该提交，丢弃指定提交之后的所有更改和未跟踪文件。

# **查看历史日志**

Git历史是指存储库随时间的所有更改记录。它包括按时间顺序排列的提交序列，每个提交代表存储库在特定时间点的快照。这个历史允许开发人员跟踪修改，了解代码库的演变，并通过提供有关谁进行了更改、何时以及为什么的详细日志，有效地协作。像git log这样的工具有助于导航这个历史，提供对开发过程的洞察，并帮助调试和项目管理。

### `git log`

显示提交日志

### `git log --oneline`

以每行一个提交的方式显示提交摘要。

### `git log --graph`

显示提交历史的图形表示。

### `git log --stat`

显示提交历史的文件统计信息。

### `git log --pretty=format:"%h %s"`

根据指定格式格式化日志输出。

### `git log --pretty=format:"%h - %an, %ar : %s"`

提供更易读的日志格式

### `git log --author=<author>`

显示指定作者的提交。

### `git log --before=<date>`

显示指定日期之前的提交。

### `git log --after=<date>`

### `git log --since=<date>`

显示指定日期之后的提交。

### `git log --cherry-pick`

省略两个分支之间等效的提交。

### `git log --follow <file>`

显示文件的提交，包括重命名。

### `git log --show-signature`

显示提交的GPG签名信息。

### `git shortlog`

按作者汇总git log输出。

### `git shortlog -sn`

按作者汇总git log输出，显示提交计数。

### `git log --simplify-by-decoration`

仅显示被标签或分支引用的提交。

### `git log --no-merges`

从日志中省略合并提交。

### `git whatchanged`

以类似于提交日志的格式列出提交数据。

### `git diff-tree --pretty --name-only --root <commit>`

显示提交树的详细信息。

### `git log --first-parent`

仅显示当前分支的提交，排除从其他分支合并的提交。

# **差异**

Git差异是Git中的一个功能，允许您查看存储库中各种状态之间的差异。这可以包括工作目录和暂存区之间的差异，暂存区和最后提交之间的差异，或任何两个提交或分支之间的差异。通过显示文件中的逐行更改，差异帮助您在提交、合并或应用更改之前审查修改，从而确保代码库的准确性和一致性。

### `git diff`

显示存储库中各种状态之间的差异，例如工作目录和索引（暂存区）之间，索引和最后提交之间，或两个提交之间。它显示文件中的逐行更改，帮助您在提交或合并之前审查修改。

### `git diff --stat`

显示工作目录和索引（暂存区）之间更改的摘要，帮助您查看哪些文件已被修改以及添加或删除了多少行。

### `git diff --stat <commit>`

查看提交和工作目录之间的更改

### `git diff --stat <commit1> <commit2>`

提供两个提交之间更改的摘要，显示哪些文件被更改以及它们之间更改的程度。

### `git diff --stat <branch1> <branch2>`

汇总两个分支之间的差异，指示更改的文件和更改的幅度。

### `git diff --name-only <commit>`

仅显示在指定提交中更改的文件名。

### `git diff --cached`

显示暂存的更改（索引）和最后提交之间的差异，帮助