
- author: #公众号：南川随笔
- date: 2024-09-28

- 背景
- 1. 尝试直接基于大模型 C 端产品
	- Claude
	- GPT-4o
	- PerplexityAI
	- 秘塔搜索
	- 跃问
	- 关于使用大模型的核心问题
- 2. 尝试基于程序自动化
	- 2.1. 基于浏览器插件（零代码）
	- 2.2. 基于后端 selenium
	- 2.3. 做成一个前端产品？
- 注

## 背景

最近正在注册公司，突然卡在了经营范围的填写上，**遇事不决先学友商**。

1. 打开表格
	1. 列几家公司的名字：百川、智谱、月之暗面、阶跃……
	2. 列几个指标项：公司全名、公司法人、注册资本、经营范围……
2. 打开企查查
	1. 手动一一输入这几家公司的名字……
	2. 手动提取对应的内容到表格……

发现问题：这个过程很显然是可以高度自动化的，其中最小环节也是核心环节也就是打开目标公司的企查查页面，然后提取网页内容。

考虑到调研公司是一个常见的需求（包括：新增公司、新增指标项等），所以，我们应该实现该任务的自动化。
 

在经历 2 小时的研究之后，我们得到了：
1. 一份大模型行业主要公司主要指标项的透视表
2. 一份适用于企查查导出公司数据的 web-scrape sitemap
3. 一个在企查查页面直接导出结构化数据的 chrome 插件
4. 一个直接输入公司列表就能生成透视表的网站

以下开始我们的冒险之旅。

## 1. 尝试直接基于大模型 C 端产品

考虑到目前大模型已经初步具有强大的信息整合（甚至抓取能力），因此我们优先尝试使用 C 端的大模型产品解决我们的问题。

我能第一时间想到的几个大模型是 Claude、GPT-4o、pplx、秘塔。

### Claude

首先是最近被 #李继刚老师 一手捧火的 claude ，claude 最大的优势一个是指令遵循的能力较强，一个是 artifact 十分友好，它的输出如下：

![Claude 多轮对话后的输出结果](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928101925.png)

但得到这个表格不太容易，因为存在幻觉问题，以及排版问题。

关于幻觉，它的解决办法也十分简单粗暴：
1. 直接基于自己的经验妄自瞎改。例：在我指出智谱不应该是股份公司的时候，它改成了责任公司，实际全称是「北京智谱华章科技有限公司」。
2. 直接置空。例：在我指出月之暗面法人是错误的时候，它改成了「未知」。

![Company Information Table Claude Sep 28 (1).jpeg](https://poketto.oss-cn-hangzhou.aliyuncs.com/Company%20Information%20Table%20Claude%20Sep%2028%20(1).jpeg)


而关于排版问题，这个模型层面不背锅，主要是 markdown 格式本身在表格渲染上就比较麻烦，尤其是某一个单元格非常宽的时候，需要加一些限定修饰语或者升级成 html 的表格才行，这里仅做一个简单的试验让大家明白在不加悉心指导的前提下大模型也无法完成这样看似简单实则不简单的事。

### GPT-4o

hmmm，不多说了。

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928111930.png)
### PerplexityAI

pplx 一度是全村最靓的仔，让一众二线大模型公司/创业公司拍腿直呼：**原来包壳也能胜利！**

但加入各种来源校验后的实际效果如何呢？

依旧幻觉可怕地离谱。
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928111748.png)

### 秘塔搜索

pplx 不行，那国产之光秘塔呢，我们赶紧试一试！

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928121852.png)

乍一看表格结果”似乎“靠谱多了。

但是这右边的思维导图是怎么回事……

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928123305.png)

不多评价了。。

### 跃问

一线大模型公司阶跃星辰自己的信息整合能力如何呢？

我试了一下阶跃的跃问，在未登录的情况下始终无法生成表格，登录后就可以，可能是不同登录状态背后使用的模型不太一样（不确定）。

输出结果里，阶跃自己的信息是完全正确的，其他公司有标的选错的问题，智谱选了上海的某家，但法人却是北京的，说明这里不是结构化按行绑定的。

在明确标的后，进一步查询，可以看到信息基本正确了，从这点上看，还是具备与用户人机结合一起研究的能力的，信息搜索能力不错，幻觉问题相比其他几家要好很多。

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928130259.png)



### 关于使用大模型的核心问题

今日在我们 CS 魔法社群内交流时，马占凯老师比较了”不同信息源“的搜索结果，指出「大家有严肃问题，一定要反复核实，否则AI搜索也会有很大问题」，私以为也颇有启发。

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928114017.png)

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928113650.png)

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928113656.png)
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928113701.png)


## 2. 尝试基于程序自动化

### 2.1. 基于浏览器插件（零代码）

基于上述大模型产品的体验，在实际工作流里，我们还需十分谨慎。

个人认为在模型智商不错的情况下（例如 claude），总结整理场景还是挺靠谱的，但搜索能力尙比较薄弱。

因为大量高质量的信息都藏在了各个门户网站里，大模型缺少获取的渠道，即使获取了也往往一视同仁，缺少像正常人一样对搜索结果基于经验进行主动分析的过程。

因为企查查可以免费查到绝大多数公司准确及时的基本数据，所以这个需求就更适合通过爬虫的手段解决。

考虑需求的通用性，我们采用 [Web Scraper](https://chromewebstore.google.com/detail/web-scraper-free-web-scra/jnhgnonknehpejjnehehllkliplmbmhn?hl=zh-CN) 这款插件，谷歌显示它有 70 多万用户：
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928160057.png)

> 不过类似的解决方案并不局限于浏览器内，PC 端也有八爪鱼之类的工具，都是通过提取对应网页的 css/xpath 实现数据的准确爬取。

以 [抖音（原字节跳动）](https://www.qcc.com/firm/85d0292125761b813b2408a8138f51ca.html) 为例，其页面与目标信息标记如下：

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928160757.png)


![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928161132.png)

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928161846.png)

全部选完目标元素之后效果如下：
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928162020.png)

点击 Data Preview 即可看到目标预期效果：
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928162046.png)

确定无误后即可开始爬取：
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928162110.png)
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928162119.png)
它会调用当前浏览器，自动地打开目标网页，执行数据提取操作，完了刷新一下数据即可：
![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928162202.png)

非常便利！不需要写一行代码，我们的目标就完成了！


---

尽管 web-scrape 这样的插件有如此强大的优势，但是也有几个比较显著的问题：
1. 不太支持（或者说学习曲线陡峭较高）更复杂的多次交互操作。比如我们需要在企查查的输入框不断输入新的公司名，然后在候选列表里确定目标公司网址，这个就更适合用代码去实现。
2. 完全基于 css 手段定位在非语义的情况下容易出错。比如「注册资本」的定位器是`	.cominfo-normal tr:nth-of-type(3) td:nth-of-type(2)`，表示 `class 为 cominfo-normal 下第三行第二列`，如果表格不是固定的，就会导致偏差。更稳健的办法应该是先定位到「注册资本」的单元格，然后提取它下一个单元格的内容。

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928162953.png)

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928163006.png)

因为 web-scrape 更适合批量的、固定的提取任务。
### 2.2. 基于后端 selenium

我们尝试使用 selenium 等无头浏览器手段实现更稳健地提取。

我们借助 claude 等大模型工具，写一些核心代码，主要包括：
1. 编写输入函数，自动化从候选中获取目标公司网页地址
2. 编写解析函数，从目标公司网页里提取需要的信息

> 最好提前了解目标领域常见的坑，这样才能基于大模型写出真正可用的代码

![image.png](https://poketto.oss-cn-hangzhou.aliyuncs.com/20240928191820.png)

当然，因为使用浏览器爬虫，所以必然面临爬虫与反爬虫问题，所以实际代码还是有很多额外的工作量的，具体参考：[cs-magic/scraper_companies: 基于企查查一键抓取公司数据汇总成表格](https://github.com/cs-magic/scraper_companies)，我已经测试一次性抓取如下公司通过：
```yaml
- 阿里  
- 腾讯  
- 百度在线 # 直接输入百度会跳到企查查，得百度在线  
- 抖音 # 字节跳动更名了  
- 百川智能 # 直接百川会搜到其他公司  
- 智谱  
- 月之暗面  
- 阶跃星辰  
- MiniMax # minimax 是可以正确定位到稀宇科技的  
- 零一万物
```

### 2.3. 做成一个前端产品？

反反爬与并发是这个产品体验是否优秀的关键瓶颈，如果有相关的条件，做成一个公司搜索引擎，还是挺不错的，但这太不够大模型了。。

## 注
- 本文中所有大模型平台的聊天记录导出，均基于 CS 魔法社开源的浏览器插件，欢迎大家多多支持，多多 star：https://github.com/cs-magic/exts_chrome_chatbot-exporter
- 感谢本文中多位朋友、大佬的交流、启发与支持！

